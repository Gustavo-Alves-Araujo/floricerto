<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produto - La Floricultura</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&family=Inter:wght@300;400&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bege': '#E8E3D8',
                        'bege-dark': '#D4CEC0',
                        'text-dark': '#2D2D2D',
                        'text-light': '#707070'
                    },
                    fontFamily: {
                        'serif': ['"Crimson Text"', 'serif'],
                        'sans': ['"Inter"', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            font-feature-settings: "pnum";
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-bege text-text-dark font-serif antialiased">

    <!-- Header Simplificado -->
    <header class="fixed w-full top-0 bg-bege/98 backdrop-blur-sm z-40 border-b border-text-dark/10 shadow-sm">
        <nav class="container mx-auto px-6 py-5 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-normal tracking-tight text-text-dark hover:text-text-dark/60 transition-colors duration-300">
                La Floricultura
            </a>
            
            <div class="flex items-center gap-4">
                <a href="index.html#produtos" class="hidden md:block font-sans text-sm text-text-dark hover:text-text-dark/60 transition-colors">
                    Produtos
                </a>
                <a href="admin.html" class="hidden md:block font-sans text-sm text-text-dark hover:text-text-dark/60 transition-colors">
                    Admin
                </a>
                <a href="carrinho.html" class="flex items-center gap-3 bg-text-dark text-bege px-6 py-3 rounded-full hover:bg-text-dark/90 transition-all shadow-md hover:shadow-lg">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                    </svg>
                    <span class="font-sans text-sm font-medium">Carrinho</span>
                    <span class="cart-count bg-bege text-text-dark w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">0</span>
                </a>
            </div>
        </nav>
    </header>

    <!-- Produto -->
    <section class="pt-32 pb-20 px-6 container mx-auto max-w-7xl">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
            <!-- Imagem do Produto -->
            <div class="relative">
                <div class="sticky top-32">
                    <div id="productImage" class="aspect-[3/4] rounded-2xl overflow-hidden shadow-2xl">
                        <!-- Imagem carregada via JS -->
                    </div>
                    
                    <!-- Badge da categoria -->
                    <div class="absolute top-6 right-6 bg-text-dark text-bege px-4 py-2 text-xs font-sans tracking-widest uppercase shadow-lg" id="productCategory">
                        <!-- Categoria via JS -->
                    </div>
                </div>
            </div>

            <!-- Informa√ß√µes do Produto -->
            <div class="space-y-8">
                <!-- Breadcrumb -->
                <div class="font-sans text-xs tracking-wider text-text-light">
                    <a href="index.html" class="hover:text-text-dark transition-colors">In√≠cio</a>
                    <span class="mx-2">/</span>
                    <span id="breadcrumbCategory">Produto</span>
                </div>

                <!-- Nome -->
                <h1 id="productName" class="text-4xl md:text-5xl lg:text-6xl font-light leading-tight">
                    <!-- Nome via JS -->
                </h1>

                <!-- Pre√ßo -->
                <div class="flex items-baseline gap-4">
                    <span id="productPrice" class="text-4xl font-sans font-light text-text-dark">
                        <!-- Pre√ßo via JS -->
                    </span>
                </div>

                <div class="w-full h-px bg-text-dark/10"></div>

                <!-- Descri√ß√£o -->
                <div>
                    <h3 class="text-sm font-sans tracking-widest uppercase text-text-light mb-3">Sobre este arranjo</h3>
                    <p id="productDescription" class="text-lg leading-relaxed text-text-dark/80 font-sans">
                        <!-- Descri√ß√£o via JS -->
                    </p>
                </div>

                <!-- Detalhes -->
                <div id="productDetails" class="space-y-3 text-sm font-sans text-text-light">
                    <!-- Detalhes via JS -->
                </div>

                <div class="w-full h-px bg-text-dark/10"></div>

                <!-- Quantidade e Adicionar ao Carrinho -->
                <div class="space-y-6">
                    <div class="flex items-center gap-6">
                        <label class="text-sm font-sans tracking-widest uppercase text-text-light">Quantidade</label>
                        <div class="flex items-center border-2 border-text-dark/20 rounded-lg overflow-hidden">
                            <button onclick="decreaseQty()" class="px-6 py-3 hover:bg-text-dark/5 transition-colors text-xl font-sans">‚àí</button>
                            <input type="number" id="quantity" value="1" min="1" class="w-20 text-center py-3 border-x-2 border-text-dark/20 bg-transparent font-sans focus:outline-none">
                            <button onclick="increaseQty()" class="px-6 py-3 hover:bg-text-dark/5 transition-colors text-xl font-sans">+</button>
                        </div>
                    </div>

                    <button onclick="addProductToCart()" id="addToCartBtn" class="w-full bg-text-dark text-bege py-5 text-sm font-sans tracking-widest uppercase hover:bg-text-dark/90 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        Adicionar ao Carrinho
                    </button>

                    <!-- Bot√£o Pedir Agora (escondido inicialmente) -->
                    <a href="carrinho.html" id="goToCartBtn" class="hidden w-full bg-green-600 text-white py-5 text-sm font-sans tracking-widest uppercase hover:bg-green-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 text-center block">
                        üõí Pedir Agora
                    </a>

                    <div class="grid grid-cols-2 gap-4 pt-6 border-t border-text-dark/10">
                        <div class="text-center p-4 border border-text-dark/10 rounded-lg">
                            <svg class="w-6 h-6 mx-auto mb-2 text-text-dark/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                            </svg>
                            <p class="text-xs font-sans text-text-light">Flores<br>Frescas</p>
                        </div>
                        <div class="text-center p-4 border border-text-dark/10 rounded-lg">
                            <svg class="w-6 h-6 mx-auto mb-2 text-text-dark/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <p class="text-xs font-sans text-text-light">Qualidade<br>Garantida</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Produtos Relacionados -->
        <div class="mt-32">
            <div class="flex justify-between items-end mb-12 border-b border-text-dark/10 pb-6">
                <h2 class="text-3xl md:text-4xl italic">Voc√™ tamb√©m pode gostar</h2>
            </div>
            
            <div id="relatedProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <!-- Produtos relacionados via JS -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-bege-dark/30 pt-16 pb-10 border-t border-text-dark/10 mt-20">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-12">
                <div>
                    <h3 class="text-2xl italic mb-4">La Floricultura</h3>
                    <p class="font-sans text-sm text-text-light">
                        Design bot√¢nico autoral desde 2026.
                    </p>
                </div>
                
                <div>
                    <h4 class="font-sans text-xs tracking-widest uppercase mb-4 text-text-light">Navega√ß√£o</h4>
                    <ul class="space-y-2 font-sans text-sm">
                        <li><a href="index.html" class="hover:text-text-dark/60 transition-colors">In√≠cio</a></li>
                        <li><a href="carrinho.html" class="hover:text-text-dark/60 transition-colors">Carrinho</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-sans text-xs tracking-widest uppercase mb-4 text-text-light">Contato</h4>
                    <ul class="space-y-2 font-sans text-sm text-text-light">
                        <li>contato@lafloricultura.com</li>
                        <li>(21) 99999-9999</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-text-dark/10 pt-6 text-center text-xs font-sans text-text-light uppercase tracking-wider">
                <p>&copy; 2026 La Floricultura. Rio de Janeiro.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Inicializar Supabase
        const supabaseClient = window.supabase.createClient(
            'https://nrgwldtmucptrhoyqted.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yZ3dsZHRtdWNwdHJob3lxdGVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzNTkxMjAsImV4cCI6MjA4NTkzNTEyMH0.8PLX18bXir94kCS5epFEyFGGEHxwKC3YANvwLE1SjmI'
        );
        
        window.supabaseDB = {
            getAllProducts: async () => {
                const { data, error } = await supabaseClient.from('produtos').select('*').order('id');
                if (error) throw error;
                return data || [];
            },
            getOrderBumps: async () => {
                const { data, error } = await supabaseClient.from('produtos').select('*').eq('tipo', 'order_bump').order('id');
                if (error) throw error;
                return data || [];
            },
            getProductById: async (id) => {
                const { data, error } = await supabaseClient.from('produtos').select('*').eq('id', id).single();
                if (error) throw error;
                return data;
            }
        };
    </script>
    <script src="js/produtos.js"></script>
    <script src="js/cart.js"></script>
    <script>
        let currentProduct = null;

        function getProductIdFromURL() {
            const params = new URLSearchParams(window.location.search);
            return parseInt(params.get('id'));
        }

        async function renderProduct() {
            // Aguardar carregamento dos produtos
            if (!produtos || produtos.length === 0) {
                await loadProdutos();
            }
            
            const productId = getProductIdFromURL();
            currentProduct = produtos.find(p => p.id === productId);
            
            if (!currentProduct) {
                window.location.href = 'index.html';
                return;
            }

            // Atualizar t√≠tulo da p√°gina
            document.title = `${currentProduct.nome} - La Floricultura`;

            // Imagem
            document.getElementById('productImage').innerHTML = `
                <img src="${currentProduct.imagem}" alt="${currentProduct.nome}" class="w-full h-full object-cover">
            `;

            // Categoria badge
            document.getElementById('productCategory').textContent = currentProduct.categoria;
            document.getElementById('breadcrumbCategory').textContent = currentProduct.categoria;

            // Nome
            document.getElementById('productName').textContent = currentProduct.nome;

            // Pre√ßo
            document.getElementById('productPrice').textContent = `R$ ${currentProduct.preco.toFixed(2)}`;

            // Descri√ß√£o
            document.getElementById('productDescription').textContent = currentProduct.descricao;

            // Detalhes
            const detailsHTML = [];
            if (currentProduct.altura) detailsHTML.push(`<div class="flex justify-between"><span>Altura:</span><span class="text-text-dark">${currentProduct.altura}</span></div>`);
            if (currentProduct.largura) detailsHTML.push(`<div class="flex justify-between"><span>Largura:</span><span class="text-text-dark">${currentProduct.largura}</span></div>`);
            if (currentProduct.ocasiao) detailsHTML.push(`<div class="flex justify-between"><span>Ocasi√£o:</span><span class="text-text-dark">${currentProduct.ocasiao}</span></div>`);
            if (currentProduct.duracao) detailsHTML.push(`<div class="flex justify-between"><span>Dura√ß√£o:</span><span class="text-text-dark">${currentProduct.duracao}</span></div>`);
            
            document.getElementById('productDetails').innerHTML = detailsHTML.join('');

            // Produtos relacionados (mesma categoria)
            renderRelatedProducts();
        }

        function renderRelatedProducts() {
            // Pegar produtos aleat√≥rios excluindo o produto atual
            const availableProducts = produtos.filter(p => p.id !== currentProduct.id);
            
            // Embaralhar e pegar os primeiros 5
            const shuffled = availableProducts.sort(() => 0.5 - Math.random());
            const related = shuffled.slice(0, 5);

            const container = document.getElementById('relatedProducts');

            container.innerHTML = related.map(produto => `
                <div class="group">
                    <a href="produto.html?id=${produto.id}">
                        <div class="relative overflow-hidden mb-4 aspect-[3/4] rounded-lg shadow-lg group-hover:shadow-2xl transition-all duration-500">
                            <img src="${produto.imagem}" alt="${produto.nome}" class="w-full h-full object-cover transition-all duration-700 transform group-hover:scale-105">
                        </div>
                        <h3 class="font-serif text-lg mb-2 text-center group-hover:text-text-dark/60 transition-colors">${produto.nome}</h3>
                        <p class="font-sans text-lg text-center text-text-light">R$ ${produto.preco.toFixed(2)}</p>
                    </a>
                </div>
            `).join('');
        }

        function increaseQty() {
            const input = document.getElementById('quantity');
            input.value = parseInt(input.value) + 1;
        }

        function decreaseQty() {
            const input = document.getElementById('quantity');
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
            }
        }

        function addProductToCart() {
            const qty = parseInt(document.getElementById('quantity').value);
            for (let i = 0; i < qty; i++) {
                addToCart(currentProduct.id);
            }
            
            // Feedback visual
            const addBtn = document.getElementById('addToCartBtn');
            const goToCartBtn = document.getElementById('goToCartBtn');
            const originalText = addBtn.textContent;
            
            addBtn.textContent = '‚úì Adicionado!';
            addBtn.classList.add('bg-green-600');
            
            setTimeout(() => {
                addBtn.classList.add('hidden');
                goToCartBtn.classList.remove('hidden');
            }, 1000);
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', async () => {
            await renderProduct();
        });
    </script>
</body>
</html>
</body>
</html>